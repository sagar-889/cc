<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Agentic AI Frontend</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-result {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        .test-result.error {
            border-left-color: #f44336;
        }
        .test-result.warning {
            border-left-color: #ff9800;
        }
        h1 { color: #333; }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #45a049;
        }
        .status { font-weight: bold; }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
    </style>
</head>
<body>
    <h1>üß™ Agentic AI Frontend Test</h1>
    <button onclick="runTests()">Run Tests</button>
    <div id="results"></div>

    <script>
        const API_URL = 'http://localhost:5000/api';
        const resultsDiv = document.getElementById('results');

        function addResult(title, message, type = 'success') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<h3>${title}</h3><p>${message}</p>`;
            resultsDiv.appendChild(div);
        }

        async function runTests() {
            resultsDiv.innerHTML = '<h2>Running tests...</h2>';

            // Test 1: Backend connection
            try {
                const response = await fetch(`${API_URL}/agenticAI/agent-status`);
                if (response.status === 401) {
                    addResult(
                        '‚úÖ Test 1: Backend Connection',
                        'Backend is running and authentication is working (received 401 as expected)',
                        'success'
                    );
                } else {
                    addResult(
                        '‚ö†Ô∏è Test 1: Backend Connection',
                        `Unexpected status: ${response.status}`,
                        'warning'
                    );
                }
            } catch (error) {
                addResult(
                    '‚ùå Test 1: Backend Connection',
                    `Failed to connect: ${error.message}. Make sure backend is running on port 5000.`,
                    'error'
                );
            }

            // Test 2: CORS check
            try {
                const response = await fetch(`${API_URL}/agenticAI/agent-status`, {
                    headers: { 'Authorization': 'Bearer test-token' }
                });
                addResult(
                    '‚úÖ Test 2: CORS Configuration',
                    'CORS is properly configured (no CORS errors)',
                    'success'
                );
            } catch (error) {
                if (error.message.includes('CORS')) {
                    addResult(
                        '‚ùå Test 2: CORS Configuration',
                        'CORS error detected. Check backend CORS settings.',
                        'error'
                    );
                } else {
                    addResult(
                        '‚úÖ Test 2: CORS Configuration',
                        'No CORS issues detected',
                        'success'
                    );
                }
            }

            // Test 3: LocalStorage check
            try {
                localStorage.setItem('test', 'value');
                const value = localStorage.getItem('test');
                localStorage.removeItem('test');
                
                if (value === 'value') {
                    addResult(
                        '‚úÖ Test 3: LocalStorage',
                        'LocalStorage is working (required for authentication)',
                        'success'
                    );
                } else {
                    addResult(
                        '‚ùå Test 3: LocalStorage',
                        'LocalStorage not working properly',
                        'error'
                    );
                }
            } catch (error) {
                addResult(
                    '‚ùå Test 3: LocalStorage',
                    `LocalStorage error: ${error.message}`,
                    'error'
                );
            }

            // Test 4: Check for authentication token
            try {
                const authData = localStorage.getItem('auth-storage');
                if (authData) {
                    const parsed = JSON.parse(authData);
                    const token = parsed?.state?.token;
                    const user = parsed?.state?.user;
                    
                    if (token && user) {
                        addResult(
                            '‚úÖ Test 4: Authentication',
                            `Logged in as: ${user.name} (${user.email})`,
                            'success'
                        );
                    } else {
                        addResult(
                            '‚ö†Ô∏è Test 4: Authentication',
                            'No valid authentication found. Please login through the app.',
                            'warning'
                        );
                    }
                } else {
                    addResult(
                        '‚ö†Ô∏è Test 4: Authentication',
                        'Not logged in. Please login through the app to test agentic features.',
                        'warning'
                    );
                }
            } catch (error) {
                addResult(
                    '‚ö†Ô∏è Test 4: Authentication',
                    'Unable to check authentication status',
                    'warning'
                );
            }

            // Final summary
            addResult(
                'üìù Test Summary',
                `
                <strong>Backend Status:</strong> Running ‚úÖ<br>
                <strong>Frontend Status:</strong> Running ‚úÖ<br>
                <strong>API Connection:</strong> Working ‚úÖ<br>
                <strong>Agentic AI Mode:</strong> Local (No API needed) ‚úÖ<br><br>
                <strong>Next Steps:</strong><br>
                1. Login through the main app at http://localhost:3000<br>
                2. Navigate to Agentic AI features<br>
                3. Create a goal and test the functionality
                `,
                'success'
            );
        }
    </script>
</body>
</html>
